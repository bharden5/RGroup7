library(patentsview)
library(tidyverse)

#see the working directory, set the working 
#directory 
getwd()
setwd("C:/CIS4730")

#Create query parameters
my_query = qry_funs$and(
  qry_funs$gte(patent_date = "2018-01-01"),
  qry_funs$lte(patent_date = "2018-03-31")
)

#create and refine query, save to result obj
result = search_pv(
  query = my_query,
  fields = c("patent_number","patent_date", "inventor_last_name",  
             "inventor_city",  "assignee_organization",  
             "assignee_lastknown_state"),
  all_pages = T
)
#print the results of the query
result

#write unnested results to an RDS file
write_rds(result, "patentsview_result.rds")
read_rds("patentsview_result.rds")

#save the contents of the file to a local object 
read_result = read_rds("patentsview_result.rds")

#unnest these results to a readable form and saves it to a local object
unnested_result = read_result$data$patents %>%
  unnest(inventors, .drop = F) %>%
  unnest(assignees, .drop = F)
